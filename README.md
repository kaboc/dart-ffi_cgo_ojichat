# A dart:ffi sample to use a shared library generated by cgo

## 準備
### ffigen を利用する場合

#### ffigen で用いるツールのインストール

ffigen の [Setup](https://pub.dev/packages/ffigen#setup) の項目に従って必要なツールをインストールする。

使用するための設定は `pubspec.yaml` の中に記述済みなので不要。

#### バイディングを生成

1. [cgo_ojichat](https://github.com/kaboc/cgo_ojichat) の説明に従ってライブラリを生成する
2. 生成されたライブラリを `bin/library`、ヘッダファイルを `headers` の中に置く
3. 下記コマンドを実行すると `bin/library` の中に `generated_bindings.dart` というファイルができる
4. `main.dart` にて `generated_bindings.dart` を使用する（記述済み）

```shell script
$ dart run ffigen
```

- `headers` 内には Windows の環境で生成されたヘッダファイルが予め置いてあるが、自身で `go build`
を実行して生成したファイルで上書きすること
- また、もしファイル名が異なっていれば `pubspec.yaml` 内の記述を適宜合わせること

### ffigen を利用しない場合

[こちら](https://github.com/kaboc/dart-ffi_cgo_ojichat/tree/a5690de35ddbe1e51bcf762c7b99d3abfbe11438)

## 実行

```shell script
$ dart bin/main.dart あなたのお名前
```

![Screenshot](https://user-images.githubusercontent.com/20254485/109156535-4deb0a80-77b4-11eb-9282-12872a52db7d.jpg)
